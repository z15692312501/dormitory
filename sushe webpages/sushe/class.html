<!DOCTYPE html>
<!--
BeyondAdmin - Responsive Admin Dashboard Template build with Twitter Bootstrap 3.2.0
Version: 1.0.0
Purchase: http://wrapbootstrap.com
-->

<html xmlns="http://www.w3.org/1999/xhtml">
<!-- Head -->

<head>
    <meta charset="utf-8" />
    <title>宿舍管理系统</title>

    <meta name="description" content="data tables" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" href="assets/img/favicon.png" type="image/x-icon">

    <!--Basic Styles-->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link id="bootstrap-rtl-link" href="" rel="stylesheet" />
    <link href="assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="assets/css/weather-icons.min.css" rel="stylesheet" />
    <link href="assets/css/dataTables.bootstrap.css" rel="stylesheet" />

    <!--Fonts-->
    <!-- <link href="http://fonts.useso.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300" rel="stylesheet" type="text/css"> -->

    <!--Beyond styles-->
    <link id="beyond-link" href="assets/css/beyond.min.css" rel="stylesheet" />
    <link href="assets/css/demo.min.css" rel="stylesheet" />
    <link href="assets/css/typicons.min.css" rel="stylesheet" />
    <link href="assets/css/animate.min.css" rel="stylesheet" />
    <link id="skin-link" href="" rel="stylesheet" type="text/css" />

    <!--Page Related styles-->
    <link href="assets/css/dataTables.bootstrap.css" rel="stylesheet" />

    <!--Skin Script: Place this script in head to load scripts for skins and rtl support-->
    <script src="assets/js/skins.min.js"></script>
</head>
<!-- /Head -->
<!-- Body -->

<body>
    <!-- Loading Container -->
    <div class="loading-container">
        <div class="loading-progress">
            <div class="rotator">
                <div class="rotator">
                    <div class="rotator colored">
                        <div class="rotator">
                            <div class="rotator colored">
                                <div class="rotator colored"></div>
                                <div class="rotator"></div>
                            </div>
                            <div class="rotator colored"></div>
                        </div>
                        <div class="rotator"></div>
                    </div>
                    <div class="rotator"></div>
                </div>
                <div class="rotator"></div>
            </div>
            <div class="rotator"></div>
        </div>
    </div>
    <!--  /Loading Container -->
    <!-- Navbar -->
    <div class="navbar">
        <div class="navbar-inner">
            <div class="navbar-container">
                <!-- Navbar Barnd -->
                <div class="navbar-header pull-left">
                    <a href="index.html" class="navbar-brand">
                        <div style="margin-top: 10px">
                            <strong>宿舍管理系统</strong>
                        </div>
                    </a>
                </div>
                <div class="navbar-header pull-right" style="text-align:right">
                    <a href="login.html" class="btn" style="margin: 4px 20px 2px 0px; color:red; border-color: red">注销</a>
                </div>
                <!-- /Navbar Barnd -->
                <!-- Sidebar Collapse -->
                <div class="sidebar-collapse" id="sidebar-collapse">
                    <i class="collapse-icon fa fa-bars"></i>
                </div>
                <!-- /Sidebar Collapse -->
            </div>
        </div>
    </div>
    <!-- /Navbar -->
    <!-- Main Container -->
    <div class="main-container container-fluid">
        <!-- Page Container -->
        <div class="page-container">
            <!-- Page Sidebar -->
            <div class="page-sidebar" id="sidebar">
                <!-- /Page Sidebar Header -->
                <!-- Sidebar Menu -->
                <ul class="nav sidebar-menu">
                    <!--查询-->
                    <li>
                        <a href="index.html">
                            <i class="menu-icon glyphicon glyphicon-home"></i>
                            <span class="menu-text"> 查询 </span>
                        </a>
                    </li>
                    <!--学生信息管理-->
                    <li>
                        <a href="student.html">
                            <i class="menu-icon glyphicon glyphicon-filter"></i>
                            <span class="menu-text"> 学生信息管理 </span>
                        </a>
                    </li>
                    <!--辅导员管理-->
                    <li>
                        <a href="counsellor.html">
                            <i class="menu-icon glyphicon glyphicon-edit"></i>
                            <span class="menu-text"> 辅导员管理 </span>
                        </a>
                    </li>
                    <!--系别管理-->
                    <li>
                        <a href="department.html">
                            <i class="menu-icon glyphicon glyphicon-trash"></i>
                            <span class="menu-text"> 系别管理 </span>
                        </a>
                    </li>
                    <!--班级管理-->
                    <li>
                        <a href="class.html">
                            <i class="menu-icon glyphicon glyphicon-home"></i>
                            <span class="menu-text"> 班级管理 </span>
                        </a>
                    </li>
                    <!--楼号管理-->
                    <li>
                        <a href="building.html">
                            <i class="menu-icon glyphicon glyphicon-home"></i>
                            <span class="menu-text"> 楼号管理 </span>
                        </a>
                    </li>
                    <!--宿舍管理-->
                    <li>
                        <a href="dormitory.html">
                            <i class="menu-icon glyphicon glyphicon-home"></i>
                            <span class="menu-text"> 宿舍管理 </span>
                        </a>
                    </li>
                    <!--床位管理-->
                    <li>
                        <a href="bed.html">
                            <i class="menu-icon glyphicon glyphicon-home"></i>
                            <span class="menu-text"> 床位管理 </span>
                        </a>
                    </li>
                    <!--管理员管理-->
                    <li>
                        <a href="administrators.html">
                            <i class="menu-icon glyphicon glyphicon-filter"></i>
                            <span class="menu-text"> 管理员管理 </span>
                        </a>
                    </li>
                </ul>
                <!-- /Sidebar Menu -->
            </div>
            <!-- /Page Sidebar -->
            <!-- Page Content -->
            <div class="page-content">
                <!-- /Page Breadcrumb -->
                <!-- Page Header -->
                <div class="page-header position-relative">
                    <div class="header-title">
                        <h1>
                            班级管理
                        </h1>
                    </div>
                    <!--Header Buttons-->
                    <div class="header-buttons">
                        <a class="sidebar-toggler" href="#">
                            <i class="fa fa-arrows-h"></i>
                        </a>
                        <a class="refresh" id="refresh-toggler" href="">
                            <i class="glyphicon glyphicon-refresh"></i>
                        </a>
                        <a class="fullscreen" id="fullscreen-toggler" href="#">
                            <i class="glyphicon glyphicon-fullscreen"></i>
                        </a>
                    </div>
                    <!--Header Buttons End-->
                </div>
                <!-- /Page Header -->
                <!-- Page Body -->
                <div class="page-body">
                    <div class="row">
                        <div class="col-xs-12 col-md-12">
                            <div class="widget">
                                <div class="widget-header ">
                                    <span class="widget-caption">班级管理</span>
                                    <div class="widget-buttons">
                                        <a href="#" data-toggle="maximize">
                                            <i class="fa fa-expand"></i>
                                        </a>
                                        <a href="#" data-toggle="collapse">
                                            <i class="fa fa-minus"></i>
                                        </a>
                                        <a href="#" data-toggle="dispose">
                                            <i class="fa fa-times"></i>
                                        </a>
                                    </div>
                                </div>
                                <div class="widget-body">
                                    <div>
                                        <a id="" href="classAdd.html" class="btn btn-default" style="margin-bottom: 10px">
                                            添加班级
                                        </a>
                                    </div>
                                    <div id="search">
                                        <div class="col-sm-12 col-md-6 col-lg-3 ">
                                            <div class="form-group">
                                                <input type="text" class="form-control" id="sou" placeholder="班级、辅导员"
                                                    style="padding-bottom:1px">
                                            </div>
                                        </div>
                                        <input type="button" class="btn btn-blue" id="cha" value="查询" />
                                    </div>
                                    <table class="table table-striped table-bordered table-hover" id="simpledatatable">
                                        <thead>
                                            <tr>
                                                <th>
                                                    <div class="checker">
                                                        <span class="">
                                                            <input type="checkbox" class="group-checkable" data-set="#flip .checkboxes">
                                                        </span>
                                                    </div>
                                                </th>
                                                <th>
                                                    班级
                                                </th>
                                                <th>
                                                    所属系别
                                                </th>
                                                <th>
                                                    辅导员
                                                </th>
                                                <th>
                                                    操作
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody>

                                        </tbody>
                                    </table>
                                    <div id="cutpage" class="digg">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Page Body -->
            </div>
            <!-- /Page Content -->
        </div>
        <!-- /Page Container -->
        <!-- Main Container -->

    </div>

    <!--Basic Scripts-->
    <script src="assets/js/jquery-2.0.3.min.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>

    <!--Beyond Scripts-->
    <script src="assets/js/beyond.min.js"></script>

    <!--Page Related Scripts-->
    <script src="assets/js/datatable/jquery.dataTables.min.js"></script>
    <script src="assets/js/datatable/ZeroClipboard.js"></script>
    <script src="assets/js/datatable/dataTables.tableTools.min.js"></script>
    <script src="assets/js/datatable/dataTables.bootstrap.min.js"></script>
    <script src="assets/js/datatable/datatables-init.js"></script>
    <script>
        InitiateSimpleDataTable.init();
        InitiateEditableDataTable.init();
        InitiateExpandableDataTable.init();
        InitiateSearchableDataTable.init();
    </script>
    <!--Google Analytics::Demo Only-->
    <script>
        (function (i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date(); a = s.createElement(o),
                m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
        })(window, document, 'script', 'http://www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-52103994-1', 'auto');
        ga('send', 'pageview');

    </script>
    <script src="assets/js/clickToken_delDoc_bedTransform.js"></script>
    <script>
        var allPage
        var token = localStorage.getItem("token")
        var uid = localStorage.getItem("uid")

        // 获取当前页数
        try {
            var pageNow = document.URL.split('?')[1].split("=")[1];
        }
        catch (error) {
            // 默认转向第一页
            var pageNow = "1"
        }

        $.ajax({
            url: 'http://122.114.248.119/dormitory/public/index.php/api/grade/lst/page/' + pageNow + '/uid/' + uid + '/token/' + token,
            type: 'get', //GET
            //async: true,    //或false,是否异步
            //timeout: 5000,    //超时时间
            async: false,
            dataType: 'json',    //返回的数据格式：json/xml/html/script/jsonp/text

            success: function (data) {
                console.log(data);
                var x = data.data.data[0].id;
                for (i = 0; i < data.data.data.length; i++) {
                    $("tbody").append(
                        "<tr><td><div class='checker'><span class=''><input type='checkbox' class='checkboxes' value='1'></span></div></td><td>" +
                        data.data.data[i].class_name + "</td><td>" +
                        data.data.data[i].department_name + "</td><td>" +
                        data.data.data[i].fd_name + "</td><td><a href='classEdit.html?" + data.data.data[i].id + "'><button  class='btn btn-info btn-xs edit'>修改</button></a><button id='" + data.data.data[i].id + "' onclick='classDel(event)' class='btn btn-danger btn-xs delete'><i class='fa fa-trash-o'></i>删除</button></td></tr>"
                    )
                }
                allPage = data.data.last_page;
            },
            error: function (error) {
                alert("error")
            },
        })

        // 分页

        allPage = parseInt(allPage)

        // 生成器
        var fristkh = document.createElement("span");
        fristkh.setAttribute('class', 'disabled')
        fristkh.innerHTML = "<"

        var endkh = document.createElement('span');
        endkh.setAttribute('class', 'disabled')
        endkh.innerHTML = ">"

        var shenglue = document.createElement('a')
        shenglue.innerHTML = "..."


        if (pageNow == 1)
        // 判断为第一页
        {   // 加入不可点击< 

            document.getElementById('cutpage').appendChild(fristkh)
            console.log(allPage)

            for (var s = 1; s <= allPage; s++) {

                var doc = document.createElement("a");
                doc.setAttribute('href', 'class.html?page=' + s)
                if (s == pageNow) { doc.setAttribute('style', 'color:red') }
                doc.innerHTML = s
                document.getElementById('cutpage').appendChild(doc)
            }

            var secendPage = document.createElement("a");

            secendPage.setAttribute('href', 'class.html?page=2')
            secendPage.innerHTML = ">"
            document.getElementById('cutpage').appendChild(secendPage)

        }
        console.log(allPage)
        try {
            var pageNow = document.URL.split('?')[1].split("=")[1];
        }
        catch (error) {
            // 默认转向第一页
            var pageNow = "1"
        }
        if (pageNow == allPage) {

            // 判断为最后一页
            var fristPage = document.createElement("a");
            var lastpages = allPage - 1
            fristPage.setAttribute('href', 'class.html?page=' + lastpages)
            fristPage.innerHTML = "<"
            document.getElementById('cutpage').appendChild(fristPage)

            for (var w = 1; w <= allPage; w++) {
                var doc = document.createElement("a");
                doc.setAttribute('href', 'class.html?page=' + w)
                if (w == pageNow) { doc.setAttribute('style', 'color:red') }
                doc.innerHTML = w
                document.getElementById('cutpage').appendChild(doc)
            }

            document.getElementById('cutpage').appendChild(endkh)

        }
        // 判断为中间页
        if (pageNow != allPage && pageNow != 1) {

            var fristPage = document.createElement("a");

            var lastpages = pageNow - 1
            fristPage.setAttribute('href', 'class.html?page=' + lastpages)

            fristPage.innerHTML = "<"
            document.getElementById('cutpage').appendChild(fristPage)

            for (var e = 1; e <= allPage; e++) {
                var doc = document.createElement("a");
                doc.setAttribute('href', 'class.html?page=' + e)
                if (e == pageNow) { doc.setAttribute('style', 'color:red') }
                doc.innerHTML = e
                document.getElementById('cutpage').appendChild(doc)
            }

            var endpage = document.createElement("a");
            var nextpages = pageNow + 1
            endpage.setAttribute('href', 'class.html?page=' + nextpages)
            endpage.innerHTML = ">"
            document.getElementById('cutpage').appendChild(endpage)


        }
        // 班级删除
        function classDel(event) {
            var delClassId = event.target.id;
            $.ajax({
                url: "http://122.114.248.119/dormitory/public/index.php/api/Grade/del/id/" + delClassId + '/uid/' + uid + '/token/' + token,
                type: 'get',
                success: function (data) {
                    $(event.target).parent().parent().hide();
                    console.log(data)
                },
                error: function (error) {
                    console.log(error)
                }
            })
        }
        $("#cha").click(function () {
            console.log(document.getElementById("sou").value);
            $.ajax({
                url: 'http://122.114.248.119/dormitory/public/index.php/api/grade/lst/page/' + pageNow + '/uid/' + uid + '/token/' + token + '/sousuo/' + document.getElementById("sou").value,
                type: 'get', //GET
                //async: true,    //或false,是否异步
                //timeout: 5000,    //超时时间
                dataType: 'json',    //返回的数据格式：json/xml/html/script/jsonp/text

                success: function (data) {
                    console.log(data);
                    $("tbody").children().hide();
                    for (i = 0; i < data.data.data.length; i++) {
                        $("tbody").append(
                            "<tr><td><div class='checker'><span class=''><input type='checkbox' class='checkboxes' value='1'></span></div></td><td>" +
                            data.data.data[i].class_name + "</td><td>" +
                            data.data.data[i].department_name + "</td><td>" +
                            data.data.data[i].fd_name + "</td><td><a href='classEdit.html?" + data.data.data[i].id + "'><button  class='btn btn-info btn-xs edit'>修改</button></a><button id='" + data.data.data[i].id + "' onclick='classDel(event)' class='btn btn-danger btn-xs delete'><i class='fa fa-trash-o'></i>删除</button></td></tr>"
                        )
                    }
                    allPage = data.data.last_page;
                },
                error: function (error) {
                    alert("error")
                },
            })
        })
    </script>
</body>
<!--  /Body -->

</html>